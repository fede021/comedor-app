<!DOCTYPE html>
<html>
<head>
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>
  <h1>Retiro de comida</h1>
  {% with msgs = get_flashed_messages(with_categories=true) %}
    {% for cat, msg in msgs %}
      <div class="{{cat}}">{{msg}}</div>
    {% endfor %}
  {% endwith %}

  <div id="qr-reader" style="width:300px"></div>
  <form method="POST">
    <input name="dni" id="dni" placeholder="DNI" readonly required>
    <input name="importe" type="number" step="0.01" placeholder="Importe" required>
    <button>Retirar</button>
  </form>

  <script>
    function onScanSuccess(decodedText){
      document.getElementById('dni').value = decodedText;
      html5QrcodeScanner.clear();
    }
    const html5QrcodeScanner = new Html5QrcodeScanner(
      "qr-reader", { fps: 10, qrbox: 250 });
    html5QrcodeScanner.render(onScanSuccess);
  </script>
</body>
</html>
